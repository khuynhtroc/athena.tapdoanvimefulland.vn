!function(t){function e(e,i,n,s){var o=e.text().split(i),r="";o.length&&(t(o).each(function(t,e){r+='<span class="'+n+(t+1)+'">'+e+"</span>"+s}),e.empty().append(r))}var i={init:function(){return this.each(function(){e(t(this),"","char","")})},words:function(){return this.each(function(){e(t(this)," ","word"," ")})},lines:function(){return this.each(function(){var i="eefec303079ad17405c889e092e105b0";e(t(this).children("br").replaceWith(i).end(),i,"line","")})}};t.fn.lettering=function(e){return e&&i[e]?i[e].apply(this,[].slice.call(arguments,1)):"letters"!==e&&e?(t.error("Method "+e+" does not exist on jQuery.lettering"),this):i.init.apply(this,[].slice.call(arguments,0))}}(jQuery),function(t){t.easing.jswing=t.easing.swing,t.extend(t.easing,{def:"easeOutQuad",swing:function(e,i,n,s,o){return t.easing[t.easing.def](e,i,n,s,o)},easeInQuad:function(t,e,i,n,s){return n*(e/=s)*e+i},easeOutQuad:function(t,e,i,n,s){return-n*(e/=s)*(e-2)+i},easeInOutQuad:function(t,e,i,n,s){return(e/=s/2)<1?n/2*e*e+i:-n/2*(--e*(e-2)-1)+i},easeInCubic:function(t,e,i,n,s){return n*(e/=s)*e*e+i},easeOutCubic:function(t,e,i,n,s){return n*((e=e/s-1)*e*e+1)+i},easeInOutCubic:function(t,e,i,n,s){return(e/=s/2)<1?n/2*e*e*e+i:n/2*((e-=2)*e*e+2)+i},easeInQuart:function(t,e,i,n,s){return n*(e/=s)*e*e*e+i},easeOutQuart:function(t,e,i,n,s){return-n*((e=e/s-1)*e*e*e-1)+i},easeInOutQuart:function(t,e,i,n,s){return(e/=s/2)<1?n/2*e*e*e*e+i:-n/2*((e-=2)*e*e*e-2)+i},easeInQuint:function(t,e,i,n,s){return n*(e/=s)*e*e*e*e+i},easeOutQuint:function(t,e,i,n,s){return n*((e=e/s-1)*e*e*e*e+1)+i},easeInOutQuint:function(t,e,i,n,s){return(e/=s/2)<1?n/2*e*e*e*e*e+i:n/2*((e-=2)*e*e*e*e+2)+i},easeInSine:function(t,e,i,n,s){return-n*Math.cos(e/s*(Math.PI/2))+n+i},easeOutSine:function(t,e,i,n,s){return n*Math.sin(e/s*(Math.PI/2))+i},easeInOutSine:function(t,e,i,n,s){return-n/2*(Math.cos(Math.PI*e/s)-1)+i},easeInExpo:function(t,e,i,n,s){return 0==e?i:n*Math.pow(2,10*(e/s-1))+i},easeOutExpo:function(t,e,i,n,s){return e==s?i+n:n*(-Math.pow(2,-10*e/s)+1)+i},easeInOutExpo:function(t,e,i,n,s){return 0==e?i:e==s?i+n:(e/=s/2)<1?n/2*Math.pow(2,10*(e-1))+i:n/2*(-Math.pow(2,-10*--e)+2)+i},easeInCirc:function(t,e,i,n,s){return-n*(Math.sqrt(1-(e/=s)*e)-1)+i},easeOutCirc:function(t,e,i,n,s){return n*Math.sqrt(1-(e=e/s-1)*e)+i},easeInOutCirc:function(t,e,i,n,s){return(e/=s/2)<1?-n/2*(Math.sqrt(1-e*e)-1)+i:n/2*(Math.sqrt(1-(e-=2)*e)+1)+i},easeInElastic:function(t,e,i,n,s){var o=1.70158,r=0,a=n;if(0==e)return i;if(1==(e/=s))return i+n;if(r||(r=.3*s),a<Math.abs(n)){a=n;var o=r/4}else var o=r/(2*Math.PI)*Math.asin(n/a);return-(a*Math.pow(2,10*(e-=1))*Math.sin((e*s-o)*(2*Math.PI)/r))+i},easeOutElastic:function(t,e,i,n,s){var o=1.70158,r=0,a=n;if(0==e)return i;if(1==(e/=s))return i+n;if(r||(r=.3*s),a<Math.abs(n)){a=n;var o=r/4}else var o=r/(2*Math.PI)*Math.asin(n/a);return a*Math.pow(2,-10*e)*Math.sin((e*s-o)*(2*Math.PI)/r)+n+i},easeInOutElastic:function(t,e,i,n,s){var o=1.70158,r=0,a=n;if(0==e)return i;if(2==(e/=s/2))return i+n;if(r||(r=s*(.3*1.5)),a<Math.abs(n)){a=n;var o=r/4}else var o=r/(2*Math.PI)*Math.asin(n/a);return 1>e?-.5*(a*Math.pow(2,10*(e-=1))*Math.sin((e*s-o)*(2*Math.PI)/r))+i:a*Math.pow(2,-10*(e-=1))*Math.sin((e*s-o)*(2*Math.PI)/r)*.5+n+i},easeInBack:function(t,e,i,n,s,o){return void 0==o&&(o=1.70158),n*(e/=s)*e*((o+1)*e-o)+i},easeOutBack:function(t,e,i,n,s,o){return void 0==o&&(o=1.70158),n*((e=e/s-1)*e*((o+1)*e+o)+1)+i},easeInOutBack:function(t,e,i,n,s,o){return void 0==o&&(o=1.70158),(e/=s/2)<1?n/2*(e*e*(((o*=1.525)+1)*e-o))+i:n/2*((e-=2)*e*(((o*=1.525)+1)*e+o)+2)+i},easeInBounce:function(e,i,n,s,o){return s-t.easing.easeOutBounce(e,o-i,0,s,o)+n},easeOutBounce:function(t,e,i,n,s){return(e/=s)<1/2.75?n*(7.5625*e*e)+i:2/2.75>e?n*(7.5625*(e-=1.5/2.75)*e+.75)+i:2.5/2.75>e?n*(7.5625*(e-=2.25/2.75)*e+.9375)+i:n*(7.5625*(e-=2.625/2.75)*e+.984375)+i},easeInOutBounce:function(e,i,n,s,o){return o/2>i?.5*t.easing.easeInBounce(e,2*i,0,s,o)+n:.5*t.easing.easeOutBounce(e,2*i-o,0,s,o)+.5*s+n}})}(jQuery),function(t){"function"==typeof define&&define.amd?define(["jquery"],t):"object"==typeof exports?module.exports=t:t(jQuery)}(function(t){function e(e){var r=e||window.event,a=h.call(arguments,1),c=0,u=0,l=0,f=0;if(e=t.event.fix(r),e.type="mousewheel","detail"in r&&(l=-1*r.detail),"wheelDelta"in r&&(l=r.wheelDelta),"wheelDeltaY"in r&&(l=r.wheelDeltaY),"wheelDeltaX"in r&&(u=-1*r.wheelDeltaX),"axis"in r&&r.axis===r.HORIZONTAL_AXIS&&(u=-1*l,l=0),c=0===l?u:l,"deltaY"in r&&(l=-1*r.deltaY,c=l),"deltaX"in r&&(u=r.deltaX,0===l&&(c=-1*u)),0!==l||0!==u){if(1===r.deltaMode){var d=t.data(this,"mousewheel-line-height");c*=d,l*=d,u*=d}else if(2===r.deltaMode){var p=t.data(this,"mousewheel-page-height");c*=p,l*=p,u*=p}return f=Math.max(Math.abs(l),Math.abs(u)),(!o||o>f)&&(o=f,n(r,f)&&(o/=40)),n(r,f)&&(c/=40,u/=40,l/=40),c=Math[c>=1?"floor":"ceil"](c/o),u=Math[u>=1?"floor":"ceil"](u/o),l=Math[l>=1?"floor":"ceil"](l/o),e.deltaX=u,e.deltaY=l,e.deltaFactor=o,e.deltaMode=0,a.unshift(e,c,u,l),s&&clearTimeout(s),s=setTimeout(i,200),(t.event.dispatch||t.event.handle).apply(this,a)}}function i(){o=null}function n(t,e){return u.settings.adjustOldDeltas&&"mousewheel"===t.type&&e%120===0}var s,o,r=["wheel","mousewheel","DOMMouseScroll","MozMousePixelScroll"],a="onwheel"in document||document.documentMode>=9?["wheel"]:["mousewheel","DomMouseScroll","MozMousePixelScroll"],h=Array.prototype.slice;if(t.event.fixHooks)for(var c=r.length;c;)t.event.fixHooks[r[--c]]=t.event.mouseHooks;var u=t.event.special.mousewheel={version:"3.1.9",setup:function(){if(this.addEventListener)for(var i=a.length;i;)this.addEventListener(a[--i],e,!1);else this.onmousewheel=e;t.data(this,"mousewheel-line-height",u.getLineHeight(this)),t.data(this,"mousewheel-page-height",u.getPageHeight(this))},teardown:function(){if(this.removeEventListener)for(var t=a.length;t;)this.removeEventListener(a[--t],e,!1);else this.onmousewheel=null},getLineHeight:function(e){return parseInt(t(e)["offsetParent"in t.fn?"offsetParent":"parent"]().css("fontSize"),10)},getPageHeight:function(e){return t(e).height()},settings:{adjustOldDeltas:!0}};t.fn.extend({mousewheel:function(t){return t?this.bind("mousewheel",t):this.trigger("mousewheel")},unmousewheel:function(t){return this.unbind("mousewheel",t)}})}),function(t){function e(t){var e=t.data("_ARS_data");return e||(e={rotateUnits:"deg",scale:1,rotate:0},t.data("_ARS_data",e)),e}function i(t,e){t.css("transform","rotate("+e.rotate+e.rotateUnits+") scale("+e.scale+","+e.scale+")")}t.fn.rotate=function(n){var s,o=t(this),r=e(o);return"undefined"==typeof n?r.rotate+r.rotateUnits:(s=n.toString().match(/^(-?\d+(\.\d+)?)(.+)?$/),s&&(s[3]&&(r.rotateUnits=s[3]),r.rotate=s[1],i(o,r)),this)},t.fn.scale=function(n){var s=t(this),o=e(s);return"undefined"==typeof n?o.scale:(o.scale=n,i(s,o),this)};var n=t.fx.prototype.cur;t.fx.prototype.cur=function(){return"rotate"==this.prop?parseFloat(t(this.elem).rotate()):"scale"==this.prop?parseFloat(t(this.elem).scale()):n.apply(this,arguments)},t.fx.step.rotate=function(i){var n=e(t(i.elem));t(i.elem).rotate(i.now+n.rotateUnits)},t.fx.step.scale=function(e){t(e.elem).scale(e.now)};var s=t.fn.animate;t.fn.animate=function(i){if("undefined"!=typeof i.rotate){var n,o,r=i.rotate.toString().match(/^(([+-]=)?(-?\d+(\.\d+)?))(.+)?$/);r&&r[5]&&(n=t(this),o=e(n),o.rotateUnits=r[5]),i.rotate=r[1]}return s.apply(this,arguments)}}(jQuery),function(t){"use strict";var e="draptouch-active";window.requestAnimationFrame||(window.requestAnimationFrame=function(){return window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(t){window.setTimeout(t,1e3/60)}}()),t.support=t.support||{},t.extend(t.support,{touch:"ontouchend"in document});var i=function(){return!1},n=function(e,i){return this.settings=i,this.el=e,this.$el=t(e),this._initElements(),this};n.DATA_KEY="draptouch",n.DEFAULTS={cursor:"",decelerate:!0,triggerHardware:!1,threshold:0,y:!0,x:!0,slowdown:.9,maxvelocity:40,throttleFPS:60,movingClass:{up:"draptouch-moving-up",down:"draptouch-moving-down",left:"draptouch-moving-left",right:"draptouch-moving-right"},deceleratingClass:{up:"draptouch-decelerating-up",down:"draptouch-decelerating-down",left:"draptouch-decelerating-left",right:"draptouch-decelerating-right"}},n.prototype.start=function(e){this.settings=t.extend(this.settings,e),this.velocity=e.velocity||this.velocity,this.velocityY=e.velocityY||this.velocityY,this.settings.decelerate=!1,this._move()},n.prototype.end=function(){this.settings.decelerate=!0},n.prototype.stop=function(){this.velocity=0,this.velocityY=0,this.settings.decelerate=!0,t.isFunction(this.settings.stopped)&&this.settings.stopped.call(this)},n.prototype.detach=function(){this._detachListeners(),this.$el.removeClass(e).css("cursor","")},n.prototype.attach=function(){this.$el.hasClass(e)||(this._attachListeners(this.$el),this.$el.addClass(e).css("cursor",this.settings.cursor))},n.prototype._initElements=function(){this.$el.addClass(e),t.extend(this,{xpos:null,prevXPos:!1,ypos:null,prevYPos:!1,mouseDown:!1,throttleTimeout:1e3/this.settings.throttleFPS,lastMove:null,elementFocused:null}),this.velocity=0,this.velocityY=0,t(document).mouseup(t.proxy(this._resetMouse,this)).click(t.proxy(this._resetMouse,this)),this._initEvents(),this.$el.css("cursor",this.settings.cursor),this.settings.triggerHardware&&this.$el.css({"-webkit-transform":"translate3d(0,0,0)","-webkit-perspective":"1000","-webkit-backface-visibility":"hidden"})},n.prototype._initEvents=function(){var e=this;this.settings.events={touchStart:function(t){var i;e._useTarget(t.target,t)&&(i=t.originalEvent.touches[0],e.threshold=e._threshold(t.target,t),e._start(i.clientX,i.clientY),t.stopPropagation())},touchMove:function(t){var i;e.mouseDown&&(i=t.originalEvent.touches[0],e._inputmove(i.clientX,i.clientY),t.preventDefault&&t.preventDefault())},inputDown:function(t){e._useTarget(t.target,t)&&(e.threshold=e._threshold(t.target,t),e._start(t.clientX,t.clientY),e.elementFocused=t.target,"IMG"===t.target.nodeName&&t.preventDefault(),t.stopPropagation())},inputEnd:function(t){e._useTarget(t.target,t)&&(e._end(),e.elementFocused=null,t.preventDefault&&t.preventDefault())},inputMove:function(t){e.mouseDown&&(e._inputmove(t.clientX,t.clientY),t.preventDefault&&t.preventDefault())},scroll:function(i){t.isFunction(e.settings.moved)&&e.settings.moved.call(e,e.settings),i.preventDefault&&i.preventDefault()},inputClick:function(t){return Math.abs(e.velocity)>0?(t.preventDefault(),!1):void 0},dragStart:function(t){return e._useTarget(t.target,t)&&e.elementFocused?!1:void 0}},this._attachListeners(this.$el,this.settings)},n.prototype._inputmove=function(e,i){var n=this.$el;this.el;if((!this.lastMove||new Date>new Date(this.lastMove.getTime()+this.throttleTimeout))&&(this.lastMove=new Date,this.mouseDown&&(this.xpos||this.ypos))){var s=e-this.xpos,o=i-this.ypos;if(this.threshold>0){var r=Math.sqrt(s*s+o*o);if(this.threshold>r)return;this.threshold=0}this.elementFocused&&(t(this.elementFocused).blur(),this.elementFocused=null,n.focus()),this.settings.decelerate=!1,this.velocity=this.velocityY=0;var a=this.scrollLeft(),h=this.scrollTop();this.scrollLeft(this.settings.x?a-s:a),this.scrollTop(this.settings.y?h-o:h),this.prevXPos=this.xpos,this.prevYPos=this.ypos,this.xpos=e,this.ypos=i,this._calculateVelocities(),this._setMoveClasses(this.settings.movingClass),t.isFunction(this.settings.moved)&&this.settings.moved.call(this,this.settings)}},n.prototype._calculateVelocities=function(){this.velocity=this._capVelocity(this.prevXPos-this.xpos,this.settings.maxvelocity),this.velocityY=this._capVelocity(this.prevYPos-this.ypos,this.settings.maxvelocity)},n.prototype._end=function(){this.xpos&&this.prevXPos&&this.settings.decelerate===!1&&(this.settings.decelerate=!0,this._calculateVelocities(),this.xpos=this.prevXPos=this.mouseDown=!1,this._move())},n.prototype._useTarget=function(e,i){return t.isFunction(this.settings.filterTarget)?this.settings.filterTarget.call(this,e,i)!==!1:!0},n.prototype._threshold=function(e,i){return t.isFunction(this.settings.threshold)?this.settings.threshold.call(this,e,i):this.settings.threshold},n.prototype._start=function(t,e){this.mouseDown=!0,this.velocity=this.prevXPos=0,this.velocityY=this.prevYPos=0,this.xpos=t,this.ypos=e},n.prototype._resetMouse=function(){this.xpos=!1,this.ypos=!1,this.mouseDown=!1},n.prototype._decelerateVelocity=function(t,e){return 0===Math.floor(Math.abs(t))?0:t*e},n.prototype._capVelocity=function(t,e){var i=t;return t>0?t>e&&(i=e):0-e>t&&(i=0-e),i},n.prototype._setMoveClasses=function(t){var e=this.settings,i=this.$el;i.removeClass(e.movingClass.up).removeClass(e.movingClass.down).removeClass(e.movingClass.left).removeClass(e.movingClass.right).removeClass(e.deceleratingClass.up).removeClass(e.deceleratingClass.down).removeClass(e.deceleratingClass.left).removeClass(e.deceleratingClass.right),this.velocity>0&&i.addClass(t.right),this.velocity<0&&i.addClass(t.left),this.velocityY>0&&i.addClass(t.down),this.velocityY<0&&i.addClass(t.up)},n.prototype._move=function(){var e=(this.$el,this.el),i=this,n=i.settings;n.x&&e.scrollWidth>0?(this.scrollLeft(this.scrollLeft()+this.velocity),Math.abs(this.velocity)>0&&(this.velocity=n.decelerate?i._decelerateVelocity(this.velocity,n.slowdown):this.velocity)):this.velocity=0,n.y&&e.scrollHeight>0?(this.scrollTop(this.scrollTop()+this.velocityY),Math.abs(this.velocityY)>0&&(this.velocityY=n.decelerate?i._decelerateVelocity(this.velocityY,n.slowdown):this.velocityY)):this.velocityY=0,i._setMoveClasses(n.deceleratingClass),t.isFunction(n.moved)&&n.moved.call(this,n),Math.abs(this.velocity)>0||Math.abs(this.velocityY)>0?this.moving||(this.moving=!0,window.requestAnimationFrame(function(){i.moving=!1,i._move()})):i.stop()},n.prototype._getScroller=function(){var e=this.$el;return(this.$el.is("body")||this.$el.is("html"))&&(e=t(window)),e},n.prototype.scrollLeft=function(t){var e=this._getScroller();return"number"!=typeof t?e.scrollLeft():(e.scrollLeft(t),void(this.settings.scrollLeft=t))},n.prototype.scrollTop=function(t){var e=this._getScroller();return"number"!=typeof t?e.scrollTop():(e.scrollTop(t),void(this.settings.scrollTop=t))},n.prototype._attachListeners=function(){var e=this.$el,n=this.settings;t.support.touch&&e.bind("touchstart",n.events.touchStart).bind("touchend",n.events.inputEnd).bind("touchmove",n.events.touchMove),e.mousedown(n.events.inputDown).mouseup(n.events.inputEnd).mousemove(n.events.inputMove),e.click(n.events.inputClick).scroll(n.events.scroll).bind("selectstart",i).bind("dragstart",n.events.dragStart)},n.prototype._detachListeners=function(){var e=this.$el,n=this.settings;t.support.touch&&e.unbind("touchstart",n.events.touchStart).unbind("touchend",n.events.inputEnd).unbind("touchmove",n.events.touchMove),e.unbind("mousedown",n.events.inputDown).unbind("mouseup",n.events.inputEnd).unbind("mousemove",n.events.inputMove),e.unbind("click",n.events.inputClick).unbind("scroll",n.events.scroll).unbind("selectstart",i).unbind("dragstart",n.events.dragStart)},t.DrapTouch=n,t.fn.draptouch=function(e,i){return this.each(function(){var s=t(this),o=s.data(n.DATA_KEY),r=t.extend({},n.DEFAULTS,s.data(),"object"==typeof e&&e);o||s.data(n.DATA_KEY,o=new n(this,r)),"string"==typeof e&&o[e](i)})}}(window.jQuery||window.Zepto),function(){"use strict";var t=function(t){var e=function(e,i){this.el=t(e),this.zoomFactor=1,this.lastScale=1,this.offset={x:0,y:0},this.options=t.extend({},this.defaults,i),this.setupMarkup(),this.bindEvents(),this.update(),this.enable()},i=function(t,e){return t+e},n=function(t,e){return t>e-.01&&e+.01>t};e.prototype={defaults:{tapZoomFactor:2,zoomOutFactor:1.3,animationDuration:600,maxZoom:6,minZoom:.3,lockDragAxis:!1,use2d:!0,zoomStartEventName:"pz_zoomstart",zoomEndEventName:"pz_zoomend",dragStartEventName:"pz_dragstart",dragEndEventName:"pz_dragend",doubleTapEventName:"pz_doubletap"},handleDragStart:function(t){this.el.trigger(this.options.dragStartEventName),this.stopAnimation(),this.lastDragPosition=!1,this.hasInteraction=!0,this.handleDrag(t)},handleDrag:function(t){if(this.zoomFactor>1){var e=this.getTouches(t)[0];this.drag(e,this.lastDragPosition),this.offset=this.sanitizeOffset(this.offset),this.lastDragPosition=e}},handleDragEnd:function(){this.el.trigger(this.options.dragEndEventName),this.end()},handleZoomStart:function(){this.el.trigger(this.options.zoomStartEventName),this.stopAnimation(),this.lastScale=1,this.nthZoom=0,this.lastZoomCenter=!1,this.hasInteraction=!0},handleZoom:function(t,e){var i=this.getTouchCenter(this.getTouches(t)),n=e/this.lastScale;this.lastScale=e,this.nthZoom+=1,this.nthZoom>3&&(this.scale(n,i),this.drag(i,this.lastZoomCenter)),this.lastZoomCenter=i},handleZoomEnd:function(){this.el.trigger(this.options.zoomEndEventName),this.end()},handleDoubleTap:function(t){var e=this.getTouches(t)[0],i=this.zoomFactor>1?1:this.options.tapZoomFactor,n=this.zoomFactor,s=function(t){this.scaleTo(n+t*(i-n),e)}.bind(this);this.hasInteraction||(n>i&&(e=this.getCurrentZoomCenter()),this.animate(this.options.animationDuration,this.options.animationInterval,s,this.swing),this.el.trigger(this.options.doubleTapEventName))},sanitizeOffset:function(t){var e=(this.zoomFactor-1)*this.getContainerX(),i=(this.zoomFactor-1)*this.getContainerY(),n=Math.max(e,0),s=Math.max(i,0),o=Math.min(e,0),r=Math.min(i,0);return{x:Math.min(Math.max(t.x,o),n),y:Math.min(Math.max(t.y,r),s)}},scaleTo:function(t,e){this.scale(t/this.zoomFactor,e)},scale:function(t,e){t=this.scaleZoomFactor(t),this.addOffset({x:(t-1)*(e.x+this.offset.x),y:(t-1)*(e.y+this.offset.y)})},scaleZoomFactor:function(t){var e=this.zoomFactor;return this.zoomFactor*=t,this.zoomFactor=Math.min(this.options.maxZoom,Math.max(this.zoomFactor,this.options.minZoom)),this.zoomFactor/e},drag:function(t,e){e&&(this.options.lockDragAxis?Math.abs(t.x-e.x)>Math.abs(t.y-e.y)?this.addOffset({x:-(t.x-e.x),y:0}):this.addOffset({y:-(t.y-e.y),x:0}):this.addOffset({y:-(t.y-e.y),x:-(t.x-e.x)}))},getTouchCenter:function(t){return this.getVectorAvg(t)},getVectorAvg:function(t){return{x:t.map(function(t){return t.x}).reduce(i)/t.length,y:t.map(function(t){return t.y}).reduce(i)/t.length}},addOffset:function(t){this.offset={x:this.offset.x+t.x,y:this.offset.y+t.y}},sanitize:function(){this.zoomFactor<this.options.zoomOutFactor?this.zoomOutAnimation():this.isInsaneOffset(this.offset)&&this.sanitizeOffsetAnimation()},isInsaneOffset:function(t){var e=this.sanitizeOffset(t);return e.x!==t.x||e.y!==t.y},sanitizeOffsetAnimation:function(){var t=this.sanitizeOffset(this.offset),e={x:this.offset.x,y:this.offset.y},i=function(i){this.offset.x=e.x+i*(t.x-e.x),this.offset.y=e.y+i*(t.y-e.y),this.update()}.bind(this);this.animate(this.options.animationDuration,this.options.animationInterval,i,this.swing)},zoomOutAnimation:function(){var t=this.zoomFactor,e=1,i=this.getCurrentZoomCenter(),n=function(n){this.scaleTo(t+n*(e-t),i)}.bind(this);this.animate(this.options.animationDuration,this.options.animationInterval,n,this.swing)},updateAspectRatio:function(){this.setContainerY(this.getContainerX()/this.getAspectRatio())},getInitialZoomFactor:function(){return this.container[0].offsetWidth/this.el[0].offsetWidth},getAspectRatio:function(){return this.el[0].offsetWidth/this.el[0].offsetHeight},getCurrentZoomCenter:function(){var t=this.container[0].offsetWidth*this.zoomFactor,e=this.offset.x,i=t-e-this.container[0].offsetWidth,n=e/i,s=n*this.container[0].offsetWidth/(n+1),o=this.container[0].offsetHeight*this.zoomFactor,r=this.offset.y,a=o-r-this.container[0].offsetHeight,h=r/a,c=h*this.container[0].offsetHeight/(h+1);return 0===i&&(s=this.container[0].offsetWidth),0===a&&(c=this.container[0].offsetHeight),{x:s,y:c}},canDrag:function(){return!n(this.zoomFactor,1)},getTouches:function(t){var e=this.container.offset();return Array.prototype.slice.call(t.touches).map(function(t){return{x:t.pageX-e.left,y:t.pageY-e.top}})},animate:function(t,e,i,n,s){var o=(new Date).getTime(),r=function(){if(this.inAnimation){var a=(new Date).getTime()-o,h=a/t;a>=t?(i(1),s&&s(),this.update(),this.stopAnimation(),this.update()):(n&&(h=n(h)),i(h),this.update(),setTimeout(r,e))}}.bind(this);this.inAnimation=!0,r()},stopAnimation:function(){this.inAnimation=!1},swing:function(t){return-Math.cos(t*Math.PI)/2+.5},getContainerX:function(){return this.container[0].offsetWidth},getContainerY:function(){return this.container[0].offsetHeight},setContainerY:function(t){return this.container.height(t+100)},setupMarkup:function(){this.container=t('<div class="pinch-zoom-container"></div>'),this.el.before(this.container),this.container.append(this.el),this.container.css({overflow:"hidden",position:"relative"}),this.el.css({"-webkit-transform-origin":"0% 0%","-moz-transform-origin":"0% 0%","-ms-transform-origin":"0% 0%","-o-transform-origin":"0% 0%","transform-origin":"0% 0%",position:"absolute"})},end:function(){this.hasInteraction=!1,this.sanitize(),this.update()},bindEvents:function(){s(this.container.get(0),this),t(window).on("resize",this.update.bind(this)),t(this.el).find("img").on("load",this.update.bind(this))},update:function(){this.updatePlaned||(this.updatePlaned=!0,setTimeout(function(){this.updatePlaned=!1,this.updateAspectRatio();var t=this.getInitialZoomFactor()*this.zoomFactor,e=-this.offset.x/t,i=-this.offset.y/t,n="scale3d("+t+", "+t+",1) translate3d("+e+"px,"+i+"px,0px)",s="scale("+t+", "+t+") translate("+e+"px,"+i+"px)",o=function(){this.clone&&(this.clone.remove(),delete this.clone)}.bind(this);!this.options.use2d||this.hasInteraction||this.inAnimation?(this.is3d=!0,o(),this.el.css({"-webkit-transform":n,"-o-transform":s,"-ms-transform":s,"-moz-transform":s,transform:n})):(this.is3d&&(this.clone=this.el.clone(),this.clone.css("pointer-events","none"),this.clone.appendTo(this.container),setTimeout(o,200)),this.el.css({"-webkit-transform":s,"-o-transform":s,"-ms-transform":s,"-moz-transform":s,transform:s}),this.is3d=!1)}.bind(this),0))},enable:function(){this.enabled=!0},disable:function(){this.enabled=!1}};var s=function(t,e){var i=null,n=0,s=null,o=null,r=function(t,n){if(i!==t){if(i&&!t)switch(i){case"zoom":e.handleZoomEnd(n);break;case"drag":e.handleDragEnd(n)}switch(t){case"zoom":e.handleZoomStart(n);break;case"drag":e.handleDragStart(n)}}i=t},a=function(t){2===n?r("zoom"):1===n&&e.canDrag()?r("drag",t):r(null,t)},h=function(t){return Array.prototype.slice.call(t).map(function(t){return{x:t.pageX,y:t.pageY}})},c=function(t,e){var i,n;return i=t.x-e.x,n=t.y-e.y,Math.sqrt(i*i+n*n)},u=function(t,e){var i=c(t[0],t[1]),n=c(e[0],e[1]);return n/i},l=function(t){t.stopPropagation(),t.preventDefault()},f=function(t){var o=(new Date).getTime();if(n>1&&(s=null),300>o-s)switch(l(t),e.handleDoubleTap(t),i){case"zoom":e.handleZoomEnd(t);break;case"drag":e.handleDragEnd(t)}1===n&&(s=o)},d=!0;t.addEventListener("touchstart",function(t){e.enabled&&(d=!0,n=t.touches.length,f(t))}),t.addEventListener("touchmove",function(t){if(e.enabled){if(d)a(t),i&&l(t),o=h(t.touches);else{switch(i){case"zoom":e.handleZoom(t,u(o,h(t.touches)));break;case"drag":e.handleDrag(t)}i&&(l(t),e.update())}d=!1}}),t.addEventListener("touchend",function(t){e.enabled&&(n=t.touches.length,a(t))})};return e};"undefined"!=typeof define&&define.amd?define(["jquery"],function(e){return t(e)}):(window.Pic=window.Pic||{},window.Pic.PinchZoom=t(window.$))}.call(this),function(t,e){"function"==typeof define&&define.amd?define(["jquery"],function(i){return e(t,i)}):"object"==typeof exports?e(t,require("jquery")):e(t,t.jQuery)}("undefined"!=typeof window?window:this,function(t,e){"use strict";function i(t,e){for(var i=t.length;--i;)if(Math.round(+t[i])!==Math.round(+e[i]))return!1;return!0}function n(t){var i={range:!0,animate:!0};return"boolean"==typeof t?i.animate=t:e.extend(i,t),i}function s(t,i,n,s,o,r,a,h,c){"array"===e.type(t)?this.elements=[+t[0],+t[2],+t[4],+t[1],+t[3],+t[5],0,0,1]:this.elements=[t,i,n,s,o,r,a||0,h||0,c||1]}function o(t,e,i){this.elements=[t,e,i]}function r(t,i){if(!(this instanceof r))return new r(t,i);1!==t.nodeType&&e.error("Panzoom called on non-Element node"),e.contains(a,t)||e.error("Panzoom element must be attached to the document");var n=e.data(t,h);if(n)return n;this.options=i=e.extend({},r.defaults,i),this.elem=t;var s=this.$elem=e(t);this.$set=i.$set&&i.$set.length?i.$set:s,this.$doc=e(t.ownerDocument||a),this.$parent=s.parent(),this.parent=this.$parent[0],this.isSVG=d.test(t.namespaceURI)&&"svg"!==t.nodeName.toLowerCase(),this.panning=!1,this._buildTransform(),this._transform=e.cssProps.transform.replace(f,"-$1").toLowerCase(),this._buildTransition(),this.resetDimensions();var o=e(),c=this;e.each(["$zoomIn","$zoomOut","$zoomRange","$reset"],function(t,e){c[e]=i[e]||o}),this.enable(),this.scale=this.getMatrix()[0],this._checkPanWhenZoomed(),e.data(t,h,this)}var a=t.document,h="__pz__",c=Array.prototype.slice,u=/trident\/7./i,l=function(){if(u.test(navigator.userAgent))return!1;var t=a.createElement("input");return t.setAttribute("oninput","return"),"function"==typeof t.oninput}(),f=/([A-Z])/g,d=/^http:[\w\.\/]+svg$/,p="(\\-?\\d[\\d\\.e-]*)",m="\\,?\\s*",g=new RegExp("^matrix\\("+p+m+p+m+p+m+p+m+p+m+p+"\\)$");return s.prototype={x:function(t){var e=t instanceof o,i=this.elements,n=t.elements;return e&&3===n.length?new o(i[0]*n[0]+i[1]*n[1]+i[2]*n[2],i[3]*n[0]+i[4]*n[1]+i[5]*n[2],i[6]*n[0]+i[7]*n[1]+i[8]*n[2]):n.length===i.length?new s(i[0]*n[0]+i[1]*n[3]+i[2]*n[6],i[0]*n[1]+i[1]*n[4]+i[2]*n[7],i[0]*n[2]+i[1]*n[5]+i[2]*n[8],i[3]*n[0]+i[4]*n[3]+i[5]*n[6],i[3]*n[1]+i[4]*n[4]+i[5]*n[7],i[3]*n[2]+i[4]*n[5]+i[5]*n[8],i[6]*n[0]+i[7]*n[3]+i[8]*n[6],i[6]*n[1]+i[7]*n[4]+i[8]*n[7],i[6]*n[2]+i[7]*n[5]+i[8]*n[8]):!1},inverse:function(){var t=1/this.determinant(),e=this.elements;return new s(t*(e[8]*e[4]-e[7]*e[5]),t*-(e[8]*e[1]-e[7]*e[2]),t*(e[5]*e[1]-e[4]*e[2]),t*-(e[8]*e[3]-e[6]*e[5]),t*(e[8]*e[0]-e[6]*e[2]),t*-(e[5]*e[0]-e[3]*e[2]),t*(e[7]*e[3]-e[6]*e[4]),t*-(e[7]*e[0]-e[6]*e[1]),t*(e[4]*e[0]-e[3]*e[1]))},determinant:function(){var t=this.elements;return t[0]*(t[8]*t[4]-t[7]*t[5])-t[3]*(t[8]*t[1]-t[7]*t[2])+t[6]*(t[5]*t[1]-t[4]*t[2])}},o.prototype.e=s.prototype.e=function(t){return this.elements[t]},r.rmatrix=g,r.defaults={eventNamespace:".panzoom",transition:!0,cursor:"move",disablePan:!1,disableZoom:!1,disableXAxis:!1,disableYAxis:!1,which:1,increment:.3,linearZoom:!1,panOnlyWhenZoomed:!1,minScale:.3,maxScale:6,rangeStep:.05,duration:200,easing:"ease-in-out",contain:!1},r.prototype={constructor:r,instance:function(){return this},enable:function(){this._initStyle(),this._bind(),this.disabled=!1},disable:function(){this.disabled=!0,this._resetStyle(),this._unbind()},isDisabled:function(){return this.disabled},destroy:function(){this.disable(),e.removeData(this.elem,h)},resetDimensions:function(){this.container=this.parent.getBoundingClientRect();var t=this.elem,i=t.getBoundingClientRect(),n=Math.abs(this.scale);this.dimensions={width:i.width,height:i.height,left:e.css(t,"left",!0)||0,top:e.css(t,"top",!0)||0,border:{top:e.css(t,"borderTopWidth",!0)*n||0,bottom:e.css(t,"borderBottomWidth",!0)*n||0,left:e.css(t,"borderLeftWidth",!0)*n||0,right:e.css(t,"borderRightWidth",!0)*n||0},margin:{top:e.css(t,"marginTop",!0)*n||0,left:e.css(t,"marginLeft",!0)*n||0}}},reset:function(t){t=n(t);var e=this.setMatrix(this._origTransform,t);t.silent||this._trigger("reset",e)},resetZoom:function(t){t=n(t);var e=this.getMatrix(this._origTransform);t.dValue=e[3],this.zoom(e[0],t)},resetPan:function(t){var e=this.getMatrix(this._origTransform);this.pan(e[4],e[5],n(t))},setTransform:function(t){for(var i=this.$set,n=i.length;n--;)e.style(i[n],"transform",t),this.isSVG&&i[n].setAttribute("transform",t)},getTransform:function(t){var i=this.$set,n=i[0];return t?this.setTransform(t):(t=e.style(n,"transform"),!this.isSVG||t&&"none"!==t||(t=e.attr(n,"transform")||"none")),"none"===t||g.test(t)||this.setTransform(t=e.css(n,"transform")),t||"none"},getMatrix:function(t){var e=g.exec(t||this.getTransform());return e&&e.shift(),e||[1,0,0,1,0,0]},setMatrix:function(t,i){if(!this.disabled){i||(i={}),"string"==typeof t&&(t=this.getMatrix(t));var n=+t[0],s="undefined"!=typeof i.contain?i.contain:this.options.contain;if(s){var o=i.dims;o||(this.resetDimensions(),o=this.dimensions);var r,a,h,c=this.container,u=o.width,l=o.height,f=c.width,d=c.height,p=f/u,m=d/l;"center"!==this.$parent.css("textAlign")||"inline"!==e.css(this.elem,"display")?(h=(u-this.elem.offsetWidth)/2,r=h-o.border.left,a=u-f-h+o.border.right):r=a=(u-f)/2;var g=(l-d)/2+o.border.top,v=(l-d)/2-o.border.top-o.border.bottom;"invert"===s||"automatic"===s&&1.01>p?t[4]=Math.max(Math.min(t[4],r-o.border.left),-a):t[4]=Math.min(Math.max(t[4],r),-a),"invert"===s||"automatic"===s&&1.01>m?t[5]=Math.max(Math.min(t[5],g-o.border.top),-v):t[5]=Math.min(Math.max(t[5],g),-v)}if("skip"!==i.animate&&this.transition(!i.animate),i.range&&this.$zoomRange.val(n),this.options.disableXAxis||this.options.disableYAxis){var y=this.getMatrix();this.options.disableXAxis&&(t[4]=y[4]),this.options.disableYAxis&&(t[5]=y[5])}return this.setTransform("matrix("+t.join(",")+")"),this.scale=n,this._checkPanWhenZoomed(n),i.silent||this._trigger("change",t),t}},isPanning:function(){return this.panning},transition:function(t){if(this._transition)for(var i=t||!this.options.transition?"none":this._transition,n=this.$set,s=n.length;s--;)e.style(n[s],"transition")!==i&&e.style(n[s],"transition",i)},pan:function(t,e,i){if(!this.options.disablePan){i||(i={});var n=i.matrix;n||(n=this.getMatrix()),i.relative&&(t+=+n[4],e+=+n[5]),n[4]=t,n[5]=e,this.setMatrix(n,i),i.silent||this._trigger("pan",n[4],n[5])}},zoom:function(t,i){"object"==typeof t?(i=t,t=null):i||(i={});var n=e.extend({},this.options,i);if(!n.disableZoom){var r=!1,a=n.matrix||this.getMatrix(),h=+a[0];"number"!=typeof t&&(t=n.linearZoom?h+n.increment*(t?-1:1):t?h/(1+n.increment):h*(1+n.increment),r=!0),t=Math.max(Math.min(t,n.maxScale),n.minScale);var c=n.focal;if(c&&!n.disablePan){this.resetDimensions();var u=n.dims=this.dimensions,l=c.clientX,f=c.clientY;this.isSVG||(l-=u.width/h/2,f-=u.height/h/2);var d=new o(l,f,1),p=new s(a),m=this.parentOffset||this.$parent.offset(),g=new s(1,0,m.left-this.$doc.scrollLeft(),0,1,m.top-this.$doc.scrollTop()),v=p.inverse().x(g.inverse().x(d)),y=t/a[0];p=p.x(new s([y,0,0,y,0,0])),d=g.x(p.x(v)),a[4]=+a[4]+(l-d.e(0)),a[5]=+a[5]+(f-d.e(1))}a[0]=t,a[3]="number"==typeof n.dValue?n.dValue:t,this.setMatrix(a,{animate:"undefined"!=typeof n.animate?n.animate:r,range:!n.noSetRange}),n.silent||this._trigger("zoom",a[0],n)}},option:function(t,i){var n;if(!t)return e.extend({},this.options);if("string"==typeof t){if(1===arguments.length)return void 0!==this.options[t]?this.options[t]:null;n={},n[t]=i}else n=t;this._setOptions(n)},_setOptions:function(t){e.each(t,e.proxy(function(t,i){switch(t){case"disablePan":this._resetStyle();case"$zoomIn":case"$zoomOut":case"$zoomRange":case"$reset":case"disableZoom":case"onStart":case"onChange":case"onZoom":case"onPan":case"onEnd":case"onReset":case"eventNamespace":this._unbind()}switch(this.options[t]=i,t){case"disablePan":this._initStyle();case"$zoomIn":case"$zoomOut":case"$zoomRange":case"$reset":this[t]=i;case"disableZoom":case"onStart":case"onChange":case"onZoom":case"onPan":case"onEnd":case"onReset":case"eventNamespace":this._bind();break;case"cursor":e.style(this.elem,"cursor",i);break;case"minScale":this.$zoomRange.attr("min",i);break;case"maxScale":this.$zoomRange.attr("max",i);break;case"rangeStep":this.$zoomRange.attr("step",i);break;case"startTransform":this._buildTransform();break;case"duration":case"easing":this._buildTransition();case"transition":this.transition();break;case"panOnlyWhenZoomed":this._checkPanWhenZoomed();break;case"$set":i instanceof e&&i.length&&(this.$set=i,this._initStyle(),this._buildTransform())}},this))},_checkPanWhenZoomed:function(t){var e=this.options;if(e.panOnlyWhenZoomed){t||(t=this.getMatrix()[0]);var i=t<=e.minScale;e.disablePan!==i&&this.option("disablePan",i)}},_initStyle:function(){var t={"transform-origin":this.isSVG?"0 0":"50% 50%"};this.options.disablePan||(t.cursor=this.options.cursor),this.$set.css(t);var i=this.$parent;i.length&&!e.nodeName(this.parent,"body")&&(t={overflow:"hidden"},"static"===i.css("position")&&(t.position="relative"),i.css(t))},_resetStyle:function(){this.$elem.css({cursor:"",transition:""}),this.$parent.css({overflow:"",position:""})},_bind:function(){var t=this,i=this.options,n=i.eventNamespace,s="mousedown"+n+" pointerdown"+n+" MSPointerDown"+n,o="touchstart"+n+" "+s,a="touchend"+n+" click"+n+" pointerup"+n+" MSPointerUp"+n,h={},c=this.$reset,u=this.$zoomRange;if(e.each(["Start","Change","Zoom","Pan","End","Reset"],function(){var t=i["on"+this];e.isFunction(t)&&(h["panzoom"+this.toLowerCase()+n]=t)}),i.disablePan&&i.disableZoom||(h[o]=function(e){var n;("touchstart"===e.type?!(n=e.touches||e.originalEvent.touches)||(1!==n.length||i.disablePan)&&2!==n.length:i.disablePan||(e.which||e.originalEvent.which)!==i.which)||(e.preventDefault(),e.stopPropagation(),t._startMove(e,n))},3===i.which&&(h.contextmenu=!1)),this.$elem.on(h),c.length&&c.on(a,function(e){e.preventDefault(),t.reset()}),u.length&&u.attr({step:i.rangeStep===r.defaults.rangeStep&&u.attr("step")||i.rangeStep,min:i.minScale,max:i.maxScale}).prop({value:this.getMatrix()[0]}),!i.disableZoom){var f=this.$zoomIn,d=this.$zoomOut;f.length&&d.length&&(f.on(a,function(e){e.preventDefault(),t.zoom()}),d.on(a,function(e){e.preventDefault(),t.zoom(!0)})),u.length&&(h={},h[s]=function(){t.transition(!0)},h[(l?"input":"change")+n]=function(){t.zoom(+this.value,{noSetRange:!0})},u.on(h))}},_unbind:function(){this.$elem.add(this.$zoomIn).add(this.$zoomOut).add(this.$reset).off(this.options.eventNamespace)},_buildTransform:function(){return this._origTransform=this.getTransform(this.options.startTransform)},_buildTransition:function(){if(this._transform){var t=this.options;this._transition=this._transform+" "+t.duration+"ms "+t.easing}},_getDistance:function(t){var e=t[0],i=t[1];return Math.sqrt(Math.pow(Math.abs(i.clientX-e.clientX),2)+Math.pow(Math.abs(i.clientY-e.clientY),2))},_getMiddle:function(t){var e=t[0],i=t[1];return{clientX:(i.clientX-e.clientX)/2+e.clientX,clientY:(i.clientY-e.clientY)/2+e.clientY}},_trigger:function(t){"string"==typeof t&&(t="panzoom"+t),this.$elem.triggerHandler(t,[this].concat(c.call(arguments,1)))},_startMove:function(t,n){if(!this.panning){var s,o,r,h,c,u,l,f,d=this,p=this.options,m=p.eventNamespace,g=this.getMatrix(),v=g.slice(0),y=+v[4],w=+v[5],b={matrix:g,animate:"skip"},x=t.type;"pointerdown"===x?(s="pointermove",o="pointerup"):"touchstart"===x?(s="touchmove",o="touchend"):"MSPointerDown"===x?(s="MSPointerMove",o="MSPointerUp"):(s="mousemove",o="mouseup"),s+=m,o+=m,this.transition(!0),this.panning=!0,this._trigger("start",t,n);var M=function(t,e){if(e){if(2===e.length){if(null!=r)return;return r=d._getDistance(e),h=+g[0],void(c=d._getMiddle(e))}if(null!=u)return;(f=e[0])&&(u=f.pageX,l=f.pageY)}null==u&&(u=t.pageX,l=t.pageY)};M(t,n);var _=function(t){var e;if(t.preventDefault(),n=t.touches||t.originalEvent.touches,M(t,n),n){if(2===n.length){var i=d._getMiddle(n),s=d._getDistance(n)-r;return d.zoom(s*(p.increment/100)+h,{focal:i,matrix:g,animate:"skip"}),d.pan(+g[4]+i.clientX-c.clientX,+g[5]+i.clientY-c.clientY,b),void(c=i)}e=n[0]||{pageX:0,pageY:0}}e||(e=t),d.pan(y+e.pageX-u,w+e.pageY-l,b)};e(a).off(m).on(s,_).on(o,function(t){t.preventDefault(),e(this).off(m),d.panning=!1,t.type="panzoomend",d._trigger(t,g,!i(g,v))})}}},e.Panzoom=r,e.fn.panzoom=function(t){var i,n,s,o;return"string"==typeof t?(o=[],n=c.call(arguments,1),this.each(function(){i=e.data(this,h),i?"_"!==t.charAt(0)&&"function"==typeof(s=i[t])&&void 0!==(s=s.apply(i,n))&&o.push(s):o.push(void 0)}),o.length?1===o.length?o[0]:o:this):this.each(function(){new r(this,t)})},r}),function(t,e){"function"==typeof define&&define.amd?define("ev-emitter/ev-emitter",e):"object"==typeof module&&module.exports?module.exports=e():t.EvEmitter=e()}("undefined"!=typeof window?window:this,function(){function t(){}var e=t.prototype;return e.on=function(t,e){if(t&&e){var i=this._events=this._events||{},n=i[t]=i[t]||[];return-1==n.indexOf(e)&&n.push(e),this}},e.once=function(t,e){if(t&&e){this.on(t,e);var i=this._onceEvents=this._onceEvents||{},n=i[t]=i[t]||{};return n[e]=!0,this}},e.off=function(t,e){var i=this._events&&this._events[t];if(i&&i.length){var n=i.indexOf(e);return-1!=n&&i.splice(n,1),this}},e.emitEvent=function(t,e){var i=this._events&&this._events[t];if(i&&i.length){var n=0,s=i[n];e=e||[];for(var o=this._onceEvents&&this._onceEvents[t];s;){var r=o&&o[s];r&&(this.off(t,s),delete o[s]),s.apply(this,e),n+=r?0:1,s=i[n]}return this}},t}),function(t,e){"use strict";"function"==typeof define&&define.amd?define(["ev-emitter/ev-emitter"],function(i){return e(t,i)}):"object"==typeof module&&module.exports?module.exports=e(t,require("ev-emitter")):t.imagesLoaded=e(t,t.EvEmitter)}(window,function(t,e){function i(t,e){for(var i in e)t[i]=e[i];return t}function n(t){var e=[];if(Array.isArray(t))e=t;else if("number"==typeof t.length)for(var i=0;i<t.length;i++)e.push(t[i]);else e.push(t);return e}function s(t,e,o){return this instanceof s?("string"==typeof t&&(t=document.querySelectorAll(t)),this.elements=n(t),this.options=i({},this.options),"function"==typeof e?o=e:i(this.options,e),o&&this.on("always",o),this.getImages(),a&&(this.jqDeferred=new a.Deferred),void setTimeout(function(){this.check()}.bind(this))):new s(t,e,o)}function o(t){this.img=t}function r(t,e){this.url=t,this.element=e,this.img=new Image}var a=t.jQuery,h=t.console;s.prototype=Object.create(e.prototype),s.prototype.options={},s.prototype.getImages=function(){this.images=[],this.elements.forEach(this.addElementImages,this)},s.prototype.addElementImages=function(t){"IMG"==t.nodeName&&this.addImage(t),this.options.background===!0&&this.addElementBackgroundImages(t);var e=t.nodeType;if(e&&c[e]){for(var i=t.querySelectorAll("img"),n=0;n<i.length;n++){var s=i[n];this.addImage(s)}if("string"==typeof this.options.background){var o=t.querySelectorAll(this.options.background);for(n=0;n<o.length;n++){var r=o[n];this.addElementBackgroundImages(r)}}}};var c={1:!0,9:!0,11:!0};return s.prototype.addElementBackgroundImages=function(t){var e=getComputedStyle(t);if(e)for(var i=/url\((['"])?(.*?)\1\)/gi,n=i.exec(e.backgroundImage);null!==n;){var s=n&&n[2];s&&this.addBackground(s,t),n=i.exec(e.backgroundImage)}},s.prototype.addImage=function(t){var e=new o(t);this.images.push(e)},s.prototype.addBackground=function(t,e){var i=new r(t,e);this.images.push(i)},s.prototype.check=function(){function t(t,i,n){setTimeout(function(){e.progress(t,i,n)})}var e=this;return this.progressedCount=0,this.hasAnyBroken=!1,this.images.length?void this.images.forEach(function(e){e.once("progress",t),e.check()}):void this.complete()},s.prototype.progress=function(t,e,i){this.progressedCount++,this.hasAnyBroken=this.hasAnyBroken||!t.isLoaded,this.emitEvent("progress",[this,t,e]),this.jqDeferred&&this.jqDeferred.notify&&this.jqDeferred.notify(this,t),this.progressedCount==this.images.length&&this.complete(),this.options.debug&&h&&h.log("progress: "+i,t,e)},s.prototype.complete=function(){var t=this.hasAnyBroken?"fail":"done";if(this.isComplete=!0,this.emitEvent(t,[this]),this.emitEvent("always",[this]),this.jqDeferred){var e=this.hasAnyBroken?"reject":"resolve";this.jqDeferred[e](this)}},o.prototype=Object.create(e.prototype),o.prototype.check=function(){var t=this.getIsImageComplete();return t?void this.confirm(0!==this.img.naturalWidth,"naturalWidth"):(this.proxyImage=new Image,this.proxyImage.addEventListener("load",this),this.proxyImage.addEventListener("error",this),this.img.addEventListener("load",this),this.img.addEventListener("error",this),void(this.proxyImage.src=this.img.src))},o.prototype.getIsImageComplete=function(){return this.img.complete&&void 0!==this.img.naturalWidth},o.prototype.confirm=function(t,e){this.isLoaded=t,this.emitEvent("progress",[this,this.img,e])},o.prototype.handleEvent=function(t){var e="on"+t.type;this[e]&&this[e](t)},o.prototype.onload=function(){this.confirm(!0,"onload"),this.unbindEvents()},o.prototype.onerror=function(){this.confirm(!1,"onerror"),this.unbindEvents()},o.prototype.unbindEvents=function(){this.proxyImage.removeEventListener("load",this),this.proxyImage.removeEventListener("error",this),this.img.removeEventListener("load",this),this.img.removeEventListener("error",this)},r.prototype=Object.create(o.prototype),r.prototype.check=function(){this.img.addEventListener("load",this),this.img.addEventListener("error",this),this.img.src=this.url;var t=this.getIsImageComplete();t&&(this.confirm(0!==this.img.naturalWidth,"naturalWidth"),this.unbindEvents())},r.prototype.unbindEvents=function(){this.img.removeEventListener("load",this),this.img.removeEventListener("error",this)},r.prototype.confirm=function(t,e){this.isLoaded=t,this.emitEvent("progress",[this,this.element,e])},s.makeJQueryPlugin=function(e){e=e||t.jQuery,e&&(a=e,a.fn.imagesLoaded=function(t,e){var i=new s(this,t,e);return i.jqDeferred.promise(a(this))})},s.makeJQueryPlugin(),s});