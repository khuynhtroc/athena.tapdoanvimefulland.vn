function iOSversion(){if(/iP(hone|od|ad)/.test(navigator.platform)){var e=navigator.appVersion.match(/OS (\d+)_(\d+)_?(\d+)?/);return[parseInt(e[1],10),parseInt(e[2],10),parseInt(e[3]||0,10)]}}function changeUrl(e,t,i,n,o,s,a){if(void 0!==window.history.pushState){var r=document.URL;r!=e&&""!=e&&window.history.pushState({path:e,dataName:o,title:t,keyword:n,description:i,titleog:s,descriptionog:a},"",e)}""!=t&&($("#hdtitle").html(t),$('meta[property="og:description"]').remove(),$("#hdtitle").after('<meta property="og:description" content="'+a+'">'),$('meta[property="og:title"]').remove(),$("#hdtitle").after('<meta property="og:title" content="'+s+'">'),$('meta[property="og:url"]').remove(),$("#hdtitle").after('<meta property="og:url" content="'+e+'">'),$("meta[name=keywords]").remove(),$("#hdtitle").after('<meta name="keywords" content="'+n+'">'),$("meta[name=description]").remove(),$("#hdtitle").after('<meta name="description" content="'+i+'">')),$("#changlanguage_redirect").val(e)}function ResizeWindows(){var e=($(window).height()>$(window).width(),$(window).height()<=$(window).width()),t=$(".bg-home img, .mobile-bg img, .bg-picture img"),i=$(window).width(),n=$(window).height(),o=n/i,s=787/1440,a=700/1100,r=900/1100,c=.5625,l=n/1100,h=i/1500,d=i/1300,g=n/1300,u=i/1800,p=i/1700,f=l;f=String(parseFloat(f).toFixed(1));var m,b,v,w;if(i>1100?o>s?(b=n,m=n/s):(b=i*s,m=i):o>r?(w=n,v=n/r):(w=i*r,v=i),$(".go-top").css({display:"none",opacity:0}),$(".album-pic-center").css({height:n}),$(".content-page").css({"min-height":n-100}),$(".block, .info-block").css({width:i}),$(".colum-box-news").css({"min-height":n/2}),1100>=i){if($(".nav-click").css({display:"block"}),$(".scroll-down").css({top:n-70}),$(".video-wrap").css({width:"100%",height:"100%",margin:0}),440>=i?($(".bg-home").css({width:i,height:(i+200)*s}),$(".slider-home").css({width:"100%",height:(i+200)*s}),$(".bg-page").css({width:i,height:(i+200)*s})):i>440&&640>=i?($(".bg-home").css({width:i,height:(i+100)*s}),$(".slider-home").css({width:"100%",height:(i+100)*s}),$(".bg-page").css({width:i,height:(i+100)*s})):($(".bg-home").css({width:i,height:i*s}),$(".slider-home").css({width:"100%",height:i*s}),$(".bg-page").css({width:i,height:i*s})),$(t).css({width:"100%",height:"auto",left:"auto"}),420>=i?$(".title-page").css({height:i*a}):$(".title-page").css({height:i*s}),e?($(".apartment-bg, .typical").scale(u),$(".facilities-bg, .facilities-typical, .facilities-bg-details, .facilities-typical-details").scale(u),$(".apartment").css({height:$(".apartment-bg").height()*u}),$(".facilities-full, .info-facilities").css({height:$(".facilities-bg").height()*u}),$(".facilities-full-details, .info-facilities-details").css({height:$(".facilities-bg-details").height()*u}),$(".apartment-bg, .typical, .facilities-bg, .facilities-typical").css({left:i/2-900,top:$(".apartment, .facilities-full").height()/2-550}),$(".facilities-bg-details, .facilities-typical-details").css({left:i/2-900,top:$(".apartment, .facilities-full").height()/2-550}),$(".block-bg, .block-typical").scale(h),$(".block").css({height:$(".block-bg").height()*h}),$(".block-bg, .block-typical").css({left:i/2-900,top:$(".block").height()/2-550})):($(".apartment-bg, .typical").scale(p),$(".facilities-bg, .facilities-typical, .facilities-bg-details, .facilities-typical-details").scale(p),$(".apartment").css({height:$(".apartment-bg").height()*p}),$(".facilities-full, .info-facilities").css({height:$(".facilities-bg").height()*p}),$(".facilities-full-details, .info-facilities-details").css({height:$(".facilities-bg-details").height()*p}),$(".apartment-bg, .typical, .facilities-bg, .facilities-typical").css({left:i/2-900,top:$(".apartment, .facilities-full").height()/2-550}),$(".facilities-bg-details, .facilities-typical-details").css({left:i/2-900,top:$(".apartment, .facilities-full").height()/2-550}),$(".block-bg, .block-typical").scale(d),$(".block").css({height:$(".block-bg").height()*d}),$(".block-bg, .block-typical").css({left:i/2-900,top:$(".block").height()/2-550})),$(".info-facilities").css({top:$(".title-page").height()}),$(".apartment-info").css({width:"100%",height:"auto"}),$(".scrollB, .scrollA, .scrollC, .scrollD, .scroll-menu, .scroll-des, .scroll-pro").getNiceScroll().remove(),$(".colum-details").css({width:"100%",height:"auto"}),$(".facilities-pic").css({width:"100%",height:"auto"}),$(".text-name").css({width:"100%"}),$(".content-page").css({width:i,height:"auto"}),$(".content-house").css({width:i,height:"auto"}),$(".box-content-house").css({width:"100%"}),$(".house-details, .colum-box").css({width:i}),$(".box-content, .colum-box,  .slide-bg").css({height:"auto"}),$(".box, .box-scroll").css({height:"auto"}),$(".scroll-des").css({height:"auto"}),$(".news-home .pic img").each(function(){$(this).css({height:"auto","margin-left":0,width:"100%"})}),$("#news-page").length){var y=$(".colum-box").length,x=$(".colum-box").width();$(".box-content").width(y*x);var k=$(".colum-box.active").innerHeight();$(".box-content").css({height:k}),$(".scrollC").css({height:"auto"})}$(".library-pic-center").css({height:"auto"}),$("#facilities-page").length&&$(".description-faci, .scrollD, .faci-box-details").css({height:"auto"}),740>=i?$(".news-text img, .item-box img, .album-pic-center img, .content-text img").addClass("zoom-pic"):$(".news-text img,  .item-box img, .album-pic-center img, .content-text img").removeClass("zoom-pic")}else if(i>1100){var E=n-100,L=E/c;if($(".video-wrap").css({width:L,height:E,"margin-left":-L/2,"margin-top":-E/2+30}),$(".nav-click").css({display:"none"}),$(".scroll-down").css({display:"none",opacity:0}),$(".bg-home").css({width:i,height:n}),$(".slide-bg, .slider-home, .bg-page").css({width:"100%",height:n}),$(".slider-home-ath, .bg-home-ath").css({width:"100%",height:n}),$(t).css({width:m,height:b,left:(i-m)/2}),$(".content-page").css({width:i,height:n}),$(".box-content").css({height:n}),$(".colum-box").css({width:i,height:n}),$(".content-house").css({height:n-65,width:i}),$(".house-details").css({width:i}),$(".facilities-pic").css({width:i,height:n}),$(".text-name").css({width:$(".item-box").width()}),$(".colum-details").css({height:n,width:i-452}),$(".apartment,  .block, .facilities-full, .facilities-full-details").css({height:n}),$(".info-facilities, .info-facilities-details").css({height:n,top:0}),$(".library-pic-center").css({height:n}),n/i>.55?($(".apartment-bg, .typical").scale(g),$(".block-typical, .block-bg").scale(g),$(".facilities-bg, .facilities-typical, .facilities-bg-details, .facilities-typical-details").scale(g)):($(".apartment-bg, .typical").scale(l),$(".block-typical, .block-bg").scale(l),$(".facilities-bg, .facilities-typical, .facilities-bg-details, .facilities-typical-details").scale(l)),$(".apartment-bg, .typical").css({left:i/2-1150,top:n/2-550}),$(".block-typical, .block-bg").css({left:i/2-1200,top:n/2-650}),$(".facilities-bg, .facilities-typical, .facilities-bg-details, .facilities-typical-details").css({left:i/2-1150,top:n/2-550}),$(".news-home .pic img").each(function(){var e=$(this).height()/$(this).width();1>=e?$(this).css({height:160,"margin-left":80-$(this).width()/2,width:"auto"}):$(this).css({height:"auto","margin-left":0,width:160})}),$("#library-page").length&&$(".slide-buttons").each(function(e,t){var i=$(this).parent().parent().innerHeight();$(t).css({top:-i/2-50})}),$("#news-page").length){$(".scrollC").css({height:n-110});var y=$(".colum-box").length,x=$(".colum-box").width();$(".box-content").width(y*x)}$("#facilities-page").length&&($(".item-wrapper").css({display:"inline-block"}),$(".faci-box-details").each(function(){var e=600;e>n-300?($(this).css({height:n-320}),$(".scrollD").css({height:n-320})):($(this).css({height:"auto"}),$(".scrollD").css({height:"auto"}))})),$(".news-text img,  .item-box img, .album-pic-center img, .content-text img").removeClass("zoom-pic"),$(".sub-nav-block ul, .sub-nav-typical ul").css({width:"100%"});var y=$(".house-details").length,x=$(".house-details").width();$(".box-content-house").width(y*x)}}function initialize(){function e(){p.setAnimation(google.maps.Animation.BOUNCE)}function t(){p.setAnimation(null)}function i(){t();var e=document.createElement("div");e.innerHTML="<div class='infobox'><img src='"+r+"'  alt='"+c+"' ><h3>"+c+"</h3><p>"+o+"<br>"+g+l+"<br>"+d+h+"<br></p></div>";var i={content:e,disableAutoPan:!0,maxWidth:250,pixelOffset:new google.maps.Size(-125,-180),boxStyle:{background:"transparent",opacity:1,width:"300px"},closeBoxMargin:"0",closeBoxzIndex:"99999",closeBoxPosition:"absolute",closeBoxURL:n+"default/images/close3.png",infoBoxClearance:new google.maps.Size(1,1),isHidden:!1,pane:"floatPane",enableEventPropagation:!0},s=new InfoBox(i);s.open(v,p)}var n=($(".httpserver").text(),$(".httptemplate").text()),o=$(".infobox-address").text(),s=$(".infobox-location-lat").text(),a=$(".infobox-location-lng").text(),r=$(".infobox-image").text(),c=($(".infobox-googlemap").text(),$(".infobox-name").text()),l=$(".infobox-phone").text(),h=($(".infobox-fax").text(),$(".infobox-phone-tel").text(),$(".infobox-email").text()),d=$(".infobox-text-email").text(),g=$(".infobox-text-tel").text(),u=new google.maps.LatLng(s,a),p=null,f=[{stylers:[{hue:"#085641"},{saturation:-60},{lightness:20},{gamma:1.51}]},{featureType:"road",elementType:"geometry",stylers:[{lightness:-20},{visibility:"simplified"}]},{featureType:"road",elementType:"labels",stylers:[{visibility:"off"}]}],m=new google.maps.StyledMapType(f,{name:"Styled Map"}),b={center:u,zoom:15,scrollwheel:!0,draggable:!0,draggingCursor:"move",noclear:!0,disableDefaultUI:!0,disableDoubleClickZoom:!0,mapTypeControlOptions:{mapTypeIds:[google.maps.MapTypeId.ROADMAP,"map_style"],position:google.maps.ControlPosition.TOP_RIGHT}};google.maps.event.addDomListener(window,"resize",function(){google.maps.event.trigger(v,"resize"),v.setCenter(u),v.setZoom(15)});var v=new google.maps.Map(document.getElementById("map-canvas"),b);v.mapTypes.set("map_style",m),v.setMapTypeId("map_style");var w=n+"default/images/logo-map.png";p=new google.maps.Marker({map:v,draggable:!1,animation:google.maps.Animation.BOUNCE,position:new google.maps.LatLng(s,a),icon:w}),$(window).width()>1100&&(google.maps.event.addListener(p,"mouseover",t),google.maps.event.addListener(p,"mouseout",e)),google.maps.event.addListener(p,"click",i),ZoomControl(v)}function ZoomControl(e){$(".zoom-control a").click(function(){var t=e.getZoom();switch($(this).attr("id")){case"zoom-in":e.setZoom(++t);break;case"zoom-out":e.setZoom(--t)}return!1})}function DrawLoad(){var e=$(".load-present"),t=$(e).find("path");$(t).each(function(){var e=this.getTotalLength();isEdge?$(this).css({"stroke-dasharray":e+" "+e}):(isIE9||isIE10||isIE11)&&($(this).css({"stroke-dasharray":e+" "+e}),$(this).css({"stroke-dashoffset":e,"stroke-dasharray":e+" "+e}),$(this).stop().animate({"stroke-dashoffset":0},600,"linear",function(){$(this).stop().animate({"stroke-dashoffset":e},500,"linear")}))}),setTimeout(function(){$(".loadicon").addClass("show")},500)}function GradientText(){$(".degee-icon a, .video-icon a, .subscribe-icon a, .news-home h2").pxgradient({step:4,colors:["#f7eea1","#f0da89","#e4b45d","#e0a74d"],dir:"y"}),$(".hotline a").pxgradient({step:4,colors:["#ffffff","#d9d5b1","#d9d5b1","#ccc79c"],dir:"y"})}function Calculation(){var e=$(window).width();$(window).height();if(1100>=e){var t=0;$(".sub-news li, .sub-nav-typical li").each(function(){var e=$(this).outerWidth()+4;t+=parseInt(e),$(".sub-news ul, .sub-nav-typical ul").width(t)}),$(".scrollB").each(function(){var e=$(this).children().length,t=$(this).children().width()+5;$(this).width(e*t)})}else $("sub-nav-block ul, .sub-nav-typical ul").css({width:"100%"}),$(".sub-news ul").css({width:"95%"}),$(".scrollB").css({width:"100%"});$(".sub-nav-typical li").length>1?$(".sub-nav-typical").css({display:"block"}):$(".sub-nav-typical").css({display:"none"})}function Done(){$("html, body").scrollTop(0),ResizeWindows(),GradientText(),Calculation(),$(".title-page > h1").lettering("words").children("span").lettering().children("span").lettering(),$(".left-content h2").lettering("words").children("span").lettering(),$(".left-content h3").lettering("words").children("span").lettering(),$(".container").addClass("show"),$(".loadicon").stop().fadeOut(500,function(){ContentLoad(),$(".loadicon").removeClass("loader"),$(".loadicon").removeClass("show")})}var ua=navigator.userAgent,match=ua.match("MSIE (.)"),versions=match&&match.length>1?match[1]:"unknown",isTouchDevice="ontouchstart"in window||window.DocumentTouch&&document instanceof DocumentTouch||navigator.msMaxTouchPoints>0||navigator.maxTouchPoints>0,isDesktop=0!=$(window).width()&&!isTouchDevice,IEMobile=ua.match(/IEMobile/i),isIE9=/MSIE 9/i.test(ua),isIE10=/MSIE 10/i.test(ua),isIE11=!(!/rv:11.0/i.test(ua)||IEMobile),isOpera=!!window.opr&&!!opr.addons||!!window.opera||ua.indexOf(" OPR/")>=0,isFirefox="undefined"!=typeof InstallTrigger,isIE=!!document.documentMode,isEdge=!isIE&&!!window.StyleMedia&&!isIE11,isChrome=!!window.chrome&&!!window.chrome.webstore,isBlink=(isChrome||isOpera)&&!!window.CSS,isSafari=/constructor/i.test(window.HTMLElement)&&!ua.match(" Version/5."),isSafari5=ua.match("Safari/")&&!ua.match("Chrome")&&ua.match(" Version/5."),AndroidVersion=parseFloat(ua.slice(ua.indexOf("Android")+8)),Version=ua.match(/Android\s([0-9\.]*)/i),isIOS8=function(){var e=navigator.userAgent.toLowerCase();return/iphone os 8_/.test(e)},iOS=iOSversion(),ios,android,blackBerry,UCBrowser,Operamini,firefox,windows,smartphone,tablet,touchscreen,all,isMobile={ios:function(){return ua.match(/iPhone|iPad|iPod/i)}(),android:function(){return ua.match(/Android/i)}(),blackBerry:function(){return ua.match(/BB10|Tablet|Mobile/i)}(),UCBrowser:function(){return ua.match(/UCBrowser/i)}(),Operamini:function(){return ua.match(/Opera Mini/i)}(),windows:function(){return ua.match(/IEMobile/i)}(),smartphone:function(){return ua.match(/Android|BlackBerry|Tablet|Mobile|iPhone|iPad|iPod|Opera Mini|IEMobile/i)&&window.innerWidth<=440&&window.innerHeight<=740}(),tablet:function(){return ua.match(/Android|BlackBerry|Tablet|Mobile|iPhone|iPad|iPod|Opera Mini|IEMobile/i)&&window.innerWidth<=1366&&window.innerHeight<=800}(),all:function(){return ua.match(/Android|BlackBerry|Tablet|Mobile|iPhone|iPad|iPod|Opera Mini|IEMobile/i)}()};if(isTouchDevice&&null!==isMobile.all)var TouchLenght=!0;else if(isMobile.tablet&&isFirefox||isMobile.smartphone&&isFirefox)var TouchLenght=!0;else var TouchLenght=!1;isMobile.Operamini&&alert("Please disable Data Savings Mode"),isChrome&&$("head").append('<link rel="stylesheet" href="'+window.location.origin+'/catalog/view/theme/default/css/scrollbar.css" type="text/css" >');var AnimEnd="webkitAnimationEnd oAnimationEnd MSAnimationEnd animationend",Loadx=0;!function(e){Array.prototype.indexOf||(Array.prototype.indexOf=function(e){var t=this.length>>>0,i=Number(arguments[1])||0;for(i=0>i?Math.ceil(i):Math.floor(i),0>i&&(i+=t);t>i;i++)if(i in this&&this[i]===e)return i;return-1});var t=(e(window).height(),e(window).width(),new Array),i=0,n=!1,o="",s="",a="",r="",c=0,l=0,h={onComplete:function(){e("#qLoverlay").remove(),e("body .item-load").remove()},backgroundColor:"#fff",barColor:"#fff",barHeight:1,percentage:!0,deepSearch:!0,completeAnimation:"fade",minimumTime:500,onLoadComplete:function(){if("grow"==h.completeAnimation){var t=100,i=new Date;i.getTime()-l<h.minimumTime&&(t=h.minimumTime-(i.getTime()-l)),e("#qLbar").stop().animate({width:"100%"},t,function(){e("#qLoverlay").fadeOut(200,function(){h.onComplete(),ResizeWindows()})})}}},d=function(){var e=new Date;l=e.getTime(),g(),m()},g=function(){o=e('<div class="item-load"></div>').appendTo("body").css({display:"none",width:0,height:0,overflow:"hidden"});for(var i=0;t.length>i;i++)e.ajax({url:t[i],type:"HEAD",success:function(){n||(c++,u(this.url))}})},u=function(t){e("<img/>").attr("src",t).bind("load",function(){p()}).appendTo(o)},p=function(){i++;var t=i/c*100;e(a).stop().animate({width:t+"%",minWidth:t+"%"},200),1==h.percentage&&e(r).text(Math.ceil(t)+"%"),i==c&&f()},f=function(){e(o).remove(),h.onLoadComplete(),n=!0},m=function(){s=e('<div id="qLoverlay"></div>').css({width:"100%",height:"10px",position:"absolute",zIndex:1e3,top:0,left:0}).appendTo("body"),a=e('<div id="qLbar"></div>').css({height:h.barHeight+"px",backgroundColor:h.barColor,width:"0%",position:"absolute",top:"0px"}).appendTo(s),1==h.percentage&&(r=e('<div id="qLpercentage"></div>').text("0%").css({height:"120px",width:"120px",position:"absolute",fontSize:"0px",top:"50%",left:"50%",marginTop:"60px",textAlign:"center",marginLeft:"-60px",color:"#fff"}).appendTo(s))},b=function(i){var n="";if("none"!=e(i).css("background-image"))var n=e(i).css("background-image");else if("undefined"!=typeof e(i).attr("src")&&"img"==i.nodeName.toLowerCase())var n=e(i).attr("src");if(-1==n.indexOf("gradient")){n=n.replace(/url\(\"/g,""),n=n.replace(/url\(/g,""),n=n.replace(/\"\)/g,""),n=n.replace(/\)/g,"");for(var o=n.split(", "),s=0;s<o.length;s++)if(o[s].length>0&&-1==t.indexOf(o[s])){var a="";t.push(o[s]+a)}}};e.fn.queryLoader=function(t){return t&&e.extend(h,t),this.each(function(){b(this),1==h.deepSearch&&e(this).find("*:not(script)").each(function(){b(this)})}),d(),this}}(jQuery),$(document).ready(function(){$("html, body").scrollTop(0),ResizeWindows(),(isChrome||isSafari||isMobile.ios||isMobile.android)&&$("head").append('<link rel="stylesheet" href="'+window.location.origin+'/catalog/view/theme/default/css/scrollbar.css" type="text/css" >'),$(".loadicon").hasClass("loader")||($(".loadicon").show(),$(".loadicon").addClass("loader"),DrawLoad()),$("body").queryLoader({barColor:"#fff",percentage:!1,barHeight:1,completeAnimation:"grow",minimumTime:100}),setTimeout(function(){0==Loadx&&(Loadx=1,Done())},2e3)}),function(){"use strict";function e(){}function t(e,t){for(var i=e.length;i--;)if(e[i].listener===t)return i;return-1}function i(e){return function(){return this[e].apply(this,arguments)}}var n=e.prototype,o=this,s=o.EventEmitter;n.getListeners=function(e){var t,i,n=this._getEvents();if("object"==typeof e){t={};for(i in n)n.hasOwnProperty(i)&&e.test(i)&&(t[i]=n[i])}else t=n[e]||(n[e]=[]);return t},n.flattenListeners=function(e){var t,i=[];for(t=0;t<e.length;t+=1)i.push(e[t].listener);return i},n.getListenersAsObject=function(e){var t,i=this.getListeners(e);return i instanceof Array&&(t={},t[e]=i),t||i},n.addListener=function(e,i){var n,o=this.getListenersAsObject(e),s="object"==typeof i;for(n in o)o.hasOwnProperty(n)&&-1===t(o[n],i)&&o[n].push(s?i:{listener:i,once:!1});return this},n.on=i("addListener"),n.addOnceListener=function(e,t){return this.addListener(e,{listener:t,once:!0})},n.once=i("addOnceListener"),n.defineEvent=function(e){return this.getListeners(e),this},n.defineEvents=function(e){for(var t=0;t<e.length;t+=1)this.defineEvent(e[t]);return this},n.removeListener=function(e,i){var n,o,s=this.getListenersAsObject(e);for(o in s)s.hasOwnProperty(o)&&(n=t(s[o],i),-1!==n&&s[o].splice(n,1));return this},n.off=i("removeListener"),n.addListeners=function(e,t){return this.manipulateListeners(!1,e,t)},n.removeListeners=function(e,t){return this.manipulateListeners(!0,e,t)},n.manipulateListeners=function(e,t,i){var n,o,s=e?this.removeListener:this.addListener,a=e?this.removeListeners:this.addListeners;if("object"!=typeof t||t instanceof RegExp)for(n=i.length;n--;)s.call(this,t,i[n]);else for(n in t)t.hasOwnProperty(n)&&(o=t[n])&&("function"==typeof o?s.call(this,n,o):a.call(this,n,o));return this},n.removeEvent=function(e){var t,i=typeof e,n=this._getEvents();if("string"===i)delete n[e];else if("object"===i)for(t in n)n.hasOwnProperty(t)&&e.test(t)&&delete n[t];else delete this._events;return this},n.removeAllListeners=i("removeEvent"),n.emitEvent=function(e,t){var i,n,o,s,a=this.getListenersAsObject(e);for(o in a)if(a.hasOwnProperty(o))for(n=a[o].length;n--;)i=a[o][n],i.once===!0&&this.removeListener(e,i.listener),s=i.listener.apply(this,t||[]),s===this._getOnceReturnValue()&&this.removeListener(e,i.listener);return this},n.trigger=i("emitEvent"),n.emit=function(e){var t=Array.prototype.slice.call(arguments,1);return this.emitEvent(e,t)},n.setOnceReturnValue=function(e){return this._onceReturnValue=e,this},n._getOnceReturnValue=function(){return this.hasOwnProperty("_onceReturnValue")?this._onceReturnValue:!0},n._getEvents=function(){return this._events||(this._events={})},e.noConflict=function(){return o.EventEmitter=s,e},"function"==typeof define&&define.amd?define("eventEmitter/EventEmitter",[],function(){return e}):"object"==typeof module&&module.exports?module.exports=e:this.EventEmitter=e}.call(this),function(e){function t(t){var i=e.event;return i.target=i.target||i.srcElement||t,i}var i=document.documentElement,n=function(){};i.addEventListener?n=function(e,t,i){e.addEventListener(t,i,!1)}:i.attachEvent&&(n=function(e,i,n){e[i+n]=n.handleEvent?function(){var i=t(e);n.handleEvent.call(n,i)}:function(){var i=t(e);n.call(e,i)},e.attachEvent("on"+i,e[i+n])});var o=function(){};i.removeEventListener?o=function(e,t,i){e.removeEventListener(t,i,!1)}:i.detachEvent&&(o=function(e,t,i){e.detachEvent("on"+t,e[t+i]);try{delete e[t+i]}catch(n){e[t+i]=void 0}});var s={bind:n,unbind:o};"function"==typeof define&&define.amd?define("eventie/eventie",s):e.eventie=s}(this),function(e,t){"use strict";"function"==typeof define&&define.amd?define(["eventEmitter/EventEmitter","eventie/eventie"],function(i,n){return t(e,i,n)}):"object"==typeof module&&module.exports?module.exports=t(e,require("wolfy87-eventemitter"),require("eventie")):e.imagesLoaded=t(e,e.EventEmitter,e.eventie)}(window,function(e,t,i){function n(e,t){for(var i in t)e[i]=t[i];return e}function o(e){return"[object Array]"==d.call(e)}function s(e){var t=[];if(o(e))t=e;else if("number"==typeof e.length)for(var i=0;i<e.length;i++)t.push(e[i]);else t.push(e);return t}function a(e,t,i){if(!(this instanceof a))return new a(e,t,i);"string"==typeof e&&(e=document.querySelectorAll(e)),this.elements=s(e),this.options=n({},this.options),"function"==typeof t?i=t:n(this.options,t),i&&this.on("always",i),this.getImages(),l&&(this.jqDeferred=new l.Deferred);var o=this;setTimeout(function(){o.check()})}function r(e){this.img=e}function c(e,t){this.url=e,this.element=t,this.img=new Image}var l=e.jQuery,h=e.console,d=Object.prototype.toString;a.prototype=new t,a.prototype.options={},a.prototype.getImages=function(){this.images=[];for(var e=0;e<this.elements.length;e++){var t=this.elements[e];this.addElementImages(t)}},a.prototype.addElementImages=function(e){"IMG"==e.nodeName&&this.addImage(e),this.options.background===!0&&this.addElementBackgroundImages(e);var t=e.nodeType;if(t&&g[t]){for(var i=e.querySelectorAll("img"),n=0;n<i.length;n++){var o=i[n];this.addImage(o)}if("string"==typeof this.options.background){var s=e.querySelectorAll(this.options.background);for(n=0;n<s.length;n++){var a=s[n];this.addElementBackgroundImages(a)}}}};var g={1:!0,9:!0,11:!0};a.prototype.addElementBackgroundImages=function(e){for(var t=u(e),i=/url\(['"]*([^'"\)]+)['"]*\)/gi,n=i.exec(t.backgroundImage);null!==n;){var o=n&&n[1];o&&this.addBackground(o,e),n=i.exec(t.backgroundImage)}};var u=e.getComputedStyle||function(e){return e.currentStyle};return a.prototype.addImage=function(e){var t=new r(e);this.images.push(t)},a.prototype.addBackground=function(e,t){var i=new c(e,t);this.images.push(i)},a.prototype.check=function(){function e(e,i,n){setTimeout(function(){t.progress(e,i,n)})}var t=this;if(this.progressedCount=0,this.hasAnyBroken=!1,!this.images.length)return void this.complete();for(var i=0;i<this.images.length;i++){var n=this.images[i];n.once("progress",e),n.check()}},a.prototype.progress=function(e,t,i){this.progressedCount++,this.hasAnyBroken=this.hasAnyBroken||!e.isLoaded,this.emit("progress",this,e,t),this.jqDeferred&&this.jqDeferred.notify&&this.jqDeferred.notify(this,e),this.progressedCount==this.images.length&&this.complete(),this.options.debug&&h&&h.log("progress: "+i,e,t)},a.prototype.complete=function(){var e=this.hasAnyBroken?"fail":"done";if(this.isComplete=!0,this.emit(e,this),this.emit("always",this),this.jqDeferred){var t=this.hasAnyBroken?"reject":"resolve";this.jqDeferred[t](this)}},r.prototype=new t,r.prototype.check=function(){var e=this.getIsImageComplete();return e?void this.confirm(0!==this.img.naturalWidth,"naturalWidth"):(this.proxyImage=new Image,i.bind(this.proxyImage,"load",this),i.bind(this.proxyImage,"error",this),i.bind(this.img,"load",this),i.bind(this.img,"error",this),void(this.proxyImage.src=this.img.src))},r.prototype.getIsImageComplete=function(){return this.img.complete&&void 0!==this.img.naturalWidth},r.prototype.confirm=function(e,t){this.isLoaded=e,this.emit("progress",this,this.img,t)},r.prototype.handleEvent=function(e){var t="on"+e.type;this[t]&&this[t](e)},r.prototype.onload=function(){this.confirm(!0,"onload"),this.unbindEvents()},r.prototype.onerror=function(){this.confirm(!1,"onerror"),this.unbindEvents()},r.prototype.unbindEvents=function(){i.unbind(this.proxyImage,"load",this),i.unbind(this.proxyImage,"error",this),i.unbind(this.img,"load",this),i.unbind(this.img,"error",this)},c.prototype=new r,c.prototype.check=function(){i.bind(this.img,"load",this),i.bind(this.img,"error",this),this.img.src=this.url;var e=this.getIsImageComplete();e&&(this.confirm(0!==this.img.naturalWidth,"naturalWidth"),this.unbindEvents())},c.prototype.unbindEvents=function(){i.unbind(this.img,"load",this),i.unbind(this.img,"error",this)},c.prototype.confirm=function(e,t){this.isLoaded=e,this.emit("progress",this,this.element,t)},a.makeJQueryPlugin=function(t){t=t||e.jQuery,t&&(l=t,l.fn.imagesLoaded=function(e,t){var i=new a(this,e,t);return i.jqDeferred.promise(l(this))})},a.makeJQueryPlugin(),a});